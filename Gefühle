<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Emotions-App ‚Äì Herz & Bibel</title>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <style>
    :root {
      --bg: #020617;
      --card: #0b1120;
      --accent-orange: #f97316;
      --accent-blue: #38bdf8;
      --accent-green: #22c55e;
      --accent-rose: #fb7185;
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2937;
      --shadow-soft: 0 16px 40px rgba(0,0,0,0.5);
      --radius-xl: 18px;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text-main);
      -webkit-text-size-adjust: 100%;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app {
      width: 100%;
      max-width: 480px;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    header {
      text-align: center;
      padding-top: 4px;
    }

    header h1 {
      margin: 4px 0;
      font-size: 22px;
      letter-spacing: 0.03em;
    }

    header p {
      margin: 0;
      font-size: 13px;
      color: var(--text-muted);
    }

    .card {
      background: linear-gradient(145deg, #020617, #020617, #0b1120);
      border-radius: var(--radius-xl);
      padding: 14px;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-subtle);
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-height: 280px;
    }

    .badge-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.8);
      border: 1px solid #1f2937;
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent-rose);
    }

    .badge-soft {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.5);
      border: 1px dashed #1f2937;
    }

    .title {
      font-size: 17px;
      font-weight: 600;
    }

    .calm-phrase {
      font-size: 12px;
      color: var(--accent-blue);
      margin-top: -4px;
      margin-bottom: 4px;
    }

    .text {
      font-size: 14px;
      color: #e5e7eb;
      white-space: pre-wrap;
    }

    .tile-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
      margin-top: 4px;
    }

    .tile {
      border-radius: 14px;
      padding: 9px 10px;
      font-size: 13px;
      font-weight: 500;
      border: 1px solid rgba(148,163,184,0.25);
      background: radial-gradient(circle at top left, rgba(248,250,252,0.05), transparent 55%);
      color: var(--text-main);
      cursor: pointer;
      display: flex;
      align-items: flex-start;
      gap: 6px;
      line-height: 1.3;
      box-shadow: 0 6px 18px rgba(0,0,0,0.4);
      transition: transform 0.08s ease, box-shadow 0.08s ease,
                  border-color 0.08s ease, background 0.08s ease, opacity 0.08s ease;
    }

    .tile span.emoji {
      font-size: 16px;
      flex-shrink: 0;
      margin-top: -1px;
    }

    .tile span.label {
      flex: 1;
    }

    .tile:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 3px 10px rgba(0,0,0,0.4);
      border-color: rgba(248,250,252,0.25);
      background: radial-gradient(circle at top left, rgba(248,250,252,0.1), transparent 55%);
    }

    .tile.orange {
      border-color: rgba(248,148,48,0.45);
      background: radial-gradient(circle at top left, rgba(248,148,48,0.18), transparent 60%);
    }

    .tile.blue {
      border-color: rgba(56,189,248,0.45);
      background: radial-gradient(circle at top left, rgba(56,189,248,0.16), transparent 60%);
    }

    .tile.green {
      border-color: rgba(52,211,153,0.45);
      background: radial-gradient(circle at top left, rgba(52,211,153,0.14), transparent 60%);
    }

    .tile.rose {
      border-color: rgba(251,113,133,0.45);
      background: radial-gradient(circle at top left, rgba(251,113,133,0.18), transparent 60%);
    }

    .tile.selected {
      outline: 2px solid #f97316;
      outline-offset: 1px;
      opacity: 1;
    }

    .hint {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .verse-box {
      margin-top: 4px;
      padding: 8px;
      border-radius: 12px;
      background: rgba(15,23,42,0.9);
      border: 1px solid #1f2937;
      font-size: 13px;
      color: #e5e7eb;
      white-space: pre-wrap;
    }

    .verse-ref {
      font-size: 12px;
      color: var(--accent-rose);
      margin-bottom: 2px;
    }

    .verse-text {
      font-size: 13px;
      margin-bottom: 6px;
    }

    .nav-row {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-top: 6px;
    }

    .nav-btn {
      flex: 1;
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 13px;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }

    .nav-btn span.icon {
      font-size: 14px;
    }

    .nav-btn.secondary {
      background: rgba(15,23,42,0.9);
      color: var(--text-muted);
      border: 1px solid #1f2937;
    }

    .nav-btn.primary {
      background: var(--accent-orange);
      color: #111827;
      font-weight: 600;
    }

    footer {
      font-size: 11px;
      color: var(--text-muted);
      text-align: center;
      padding-bottom: 4px;
    }

    @media (max-width: 380px) {
      .tile-grid {
        grid-template-columns: repeat(1, minmax(0, 1fr));
      }
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <h1>Emotions-App</h1>
    <p>F√ºhlen. Benennen. Von Gott st√§rken lassen.</p>
  </header>

  <div class="card">
    <div class="badge-row">
      <div class="badge">
        <div class="badge-dot"></div>
        <span id="badge-label">Schritt 1 / 8</span>
      </div>
      <div class="badge-soft" id="secondary-label"></div>
    </div>

    <div class="title" id="title"></div>
    <div class="calm-phrase" id="calm-phrase"></div>
    <div class="text" id="description"></div>

    <div class="tile-grid" id="tile-grid"></div>
    <div class="hint" id="hint"></div>

    <div class="verse-box" id="verse-box" style="display:none;">
      <div class="verse-ref" id="verse-ref"></div>
      <div class="verse-text" id="verse-text"></div>
      <div class="text" id="verse-expl"></div>
    </div>

    <div class="nav-row">
      <button class="nav-btn secondary" id="back-btn">
        <span class="icon">‚Üê</span><span>Zur√ºck</span>
      </button>
      <button class="nav-btn primary" id="next-btn">
        <span class="icon">‚û°Ô∏è</span><span id="next-label">Weiter</span>
      </button>
    </div>
  </div>

  <footer>
    Du musst nichts beweisen. Ehrlichkeit reicht f√ºr heute.
  </footer>
</div>

<script>
  const calmPhrases = [
    "Du musst jetzt nichts leisten ‚Äì du darfst einfach nur da sein.",
    "Gott ist nicht √ºberrascht von deinen Gef√ºhlen.",
    "Dein Herz darf ehrlich sein, auch wenn es chaotisch ist.",
    "Wut, Trauer, Angst ‚Äì nichts davon trennt dich von Gottes Liebe.",
    "Ein tiefer Atemzug ist auch ein Gebet: ‚ÄûHerr, hilf mir.‚Äú",
    "Du musst heute nicht perfekt reagieren. Echt reicht.",
    "Selbst im Sturm sieht Gott dich klarer als du dich selbst."
  ];

  const EMOTIONS = [
    {
      id: "wut",
      label: "Wut / √Ñrger",
      kurz: "w√ºtend",
      emoji: "üî•",
      color: "orange",
      verseRef: "Epheser 4,26",
      verseText: "Z√ºrnt ihr, so s√ºndigt nicht; die Sonne gehe nicht unter √ºber eurem Zorn.",
      expl: "Gott sagt nicht: ‚ÄûDu darfst nie w√ºtend sein.‚Äú Er nimmt deine Wut ernst. Aber er l√§dt dich ein, sie nicht in dir festzuhalten, bis sie dich oder andere zerst√∂rt. Deine Wut zeigt, dass dir etwas wichtig ist ‚Äì Respekt, Gerechtigkeit, N√§he. Du darfst damit zu ihm kommen, bevor du Menschen verletzt oder dich selbst kaputt machst. Du musst das nicht allein ordnen. Du darfst sagen: ‚ÄûHerr, du siehst, wie es in mir kocht. Hilf mir, wahr zu reden, ohne zu verletzen.‚Äú"
    },
    {
      id: "angst",
      label: "Angst / Unsicherheit",
      kurz: "√§ngstlich",
      emoji: "üò∞",
      color: "blue",
      verseRef: "Jesaja 41,10",
      verseText: "F√ºrchte dich nicht, denn ich bin mit dir; weiche nicht, denn ich bin dein Gott.",
      expl: "Angst ist kein Zeichen, dass du zu wenig glaubst. Angst zeigt, wie verletzlich du bist. Gott macht dir keine Vorw√ºrfe ‚Äì er verspricht N√§he. Er sagt nicht: ‚ÄûRei√ü dich zusammen‚Äú, sondern: ‚ÄûIch bin mit dir.‚Äú Vielleicht √§ndert er nicht sofort die Situation, aber er tr√§gt dich mitten hindurch. Du darfst √§ngstlich und gleichzeitig gehalten sein. Deine Angst ist bei ihm nicht zu viel."
    },
    {
      id: "traurig",
      label: "Traurigkeit",
      kurz: "traurig",
      emoji: "üò¢",
      color: "rose",
      verseRef: "Psalm 34,19",
      verseText: "Der HERR ist nahe denen, die zerbrochenen Herzens sind.",
      expl: "Traurigkeit hei√üt: Etwas in dir nimmt ernst, was du verloren hast oder nie hattest. Gott l√§uft an deiner Trauer nicht vorbei. Er setzt sich innerlich neben dich. Du musst sie nicht runterdr√ºcken, um ‚Äûstark‚Äú zu sein. Tr√§nen sind bei ihm kein Versagen, sondern Wahrheit. Er sieht jedes St√ºck deines gebrochenen Herzens ‚Äì und er sch√§mt sich nicht f√ºr dich."
    },
    {
      id: "ueberfordert",
      label: "√úberforderung",
      kurz: "√ºberfordert",
      emoji: "üß†",
      color: "green",
      verseRef: "Matth√§us 11,28",
      verseText: "Kommt her zu mir, alle, die ihr m√ºhselig und beladen seid; ich will euch erquicken.",
      expl: "√úberfordert zu sein hei√üt nicht, dass du versagt hast. Es hei√üt oft, dass du zu lange zu viel getragen hast. Jesus l√§dt gerade die M√ºden ein ‚Äì nicht die Souver√§nen. Du musst nicht jede Erwartung erf√ºllen. Du darfst ‚Äûzu viel‚Äú sp√ºren und damit zu ihm kommen. Vielleicht ist sein erster Schritt nicht: ‚ÄûMach weiter‚Äú, sondern: ‚ÄûLeg ab, atme, ich bin da.‚Äú"
    },
    {
      id: "scham",
      label: "Scham / Schuld",
      kurz: "besch√§mt / schuldig",
      emoji: "üôà",
      color: "blue",
      verseRef: "R√∂mer 8,1",
      verseText: "So gibt es nun keine Verdammnis f√ºr die, die in Christus Jesus sind.",
      expl: "Scham fl√ºstert dir: ‚ÄûMit dir stimmt etwas nicht. Du bist falsch.‚Äú Gott trennt aber klar zwischen dem, was du getan hast, und dem, wer du bist. Er sieht deine Fehler genauer als du ‚Äì und trotzdem spricht er keine Verdammnis √ºber dich, wenn du zu Jesus geh√∂rst. Du darfst deine Schuld benennen, aber du musst dich nicht mehr selber verurteilen. Seine Stimme ist tiefer als dein innerer Ankl√§ger."
    },
    {
      id: "einsam",
      label: "Einsamkeit",
      kurz: "einsam",
      emoji: "üåí",
      color: "rose",
      verseRef: "Psalm 27,10",
      verseText: "Wenn Vater und Mutter mich verlassen, so nimmt doch der HERR mich auf.",
      expl: "Einsamkeit ist brutal, weil sie dir sagt: ‚ÄûIch bin unwichtig. Keiner sieht mich.‚Äú Gott widerspricht dieser L√ºge. Selbst wenn Menschen dich √ºbersehen oder verlassen haben ‚Äì er tut es nicht. Er ist nicht nur theoretisch da, sondern pers√∂nlich interessiert an dir. Du darfst ihm sagen: ‚ÄûIch f√ºhle mich allein‚Äú, ohne dass er dich abwertet. Bei ihm bist du gewollt, nicht geduldet."
    },
    {
      id: "enttaeuschung",
      label: "Entt√§uschung",
      kurz: "entt√§uscht",
      emoji: "üíî",
      color: "orange",
      verseRef: "Spr√ºche 13,12",
      verseText: "Hingezogene Hoffnung macht das Herz krank.",
      expl: "Entt√§uschung zeigt, dass du gehofft hast. Dass du geglaubt hast, etwas k√∂nnte sch√∂n, heil oder anders werden. Gott macht dieses Hoffen nicht l√§cherlich. Er kennt dein krankes Herz, das m√ºde geworden ist. Bei ihm darfst du ehrlich sagen: ‚ÄûIch hatte mir mehr erhofft.‚Äú Er nimmt deine Erwartungen ernst ‚Äì und er bleibt auch dann, wenn Menschen sie nicht erf√ºllt haben."
    },
    {
      id: "erschoepft",
      label: "Ersch√∂pfung / Leer",
      kurz: "ersch√∂pft",
      emoji: "ü™´",
      color: "green",
      verseRef: "Jesaja 40,29",
      verseText: "Er gibt dem M√ºden Kraft und St√§rke genug dem Unverm√∂genden.",
      expl: "Ersch√∂pfung hei√üt oft: Du hast lange gek√§mpft, mehr gegeben, als gut war. Gott sch√§mt sich nicht f√ºr deine M√ºdigkeit. Er erwartet nicht, dass du immer funktionierst. Er kennt deine Grenzen besser als du. Du darfst aufh√∂ren, stark zu tun, und sagen: ‚ÄûHerr, ich kann nicht mehr.‚Äú Er f√§ngt dich genau dort auf."
    }
  ];

  const state = {
    step: 1,
    selectedEmotionIds: [],
    mainEmotionId: null,
    origin: null,
    frequency: null,
    coping: null,
    action: null
  };

  const badgeLabelEl = document.getElementById("badge-label");
  const secondaryLabelEl = document.getElementById("secondary-label");
  const titleEl = document.getElementById("title");
  const descEl = document.getElementById("description");
  const calmEl = document.getElementById("calm-phrase");
  const gridEl = document.getElementById("tile-grid");
  const hintEl = document.getElementById("hint");
  const verseBoxEl = document.getElementById("verse-box");
  const verseRefEl = document.getElementById("verse-ref");
  const verseTextEl = document.getElementById("verse-text");
  const verseExplEl = document.getElementById("verse-expl");
  const backBtn = document.getElementById("back-btn");
  const nextBtn = document.getElementById("next-btn");
  const nextLabelEl = document.getElementById("next-label");

  function randomPhrase() {
    return calmPhrases[Math.floor(Math.random() * calmPhrases.length)];
  }

  function getEmotionById(id) {
    return EMOTIONS.find(e => e.id === id) || null;
  }

  function setBadge() {
    badgeLabelEl.textContent = `Schritt ${state.step} / 8`;
  }

  function clearGridAndVerse() {
    gridEl.innerHTML = "";
    verseBoxEl.style.display = "none";
    hintEl.textContent = "";
    secondaryLabelEl.textContent = "";
  }

  function render() {
    setBadge();
    calmEl.textContent = randomPhrase();
    clearGridAndVerse();

    if (state.step === 1) renderStep1();
    else if (state.step === 2) renderStep2();
    else if (state.step === 3) renderStep3();
    else if (state.step === 4) renderStep4();
    else if (state.step === 5) renderStep5();
    else if (state.step === 6) renderStep6();
    else if (state.step === 7) renderStep7();
    else if (state.step === 8) renderStep8();
  }

  // Schritt 1: Anleitung / Begr√º√üung
  function renderStep1() {
    titleEl.textContent = "Guten Tag, das ist die Emotions-App.";
    descEl.textContent =
      "Sie hilft dir, deine Emotionen zu f√ºhlen und zu benennen.\n\nDu gehst Schritt f√ºr Schritt durch einige Fragen. Am Ende bekommst du einen Bibelvers und eine kleine Erkl√§rung f√ºr dein Herz.\n\nDu darfst ehrlich sein. Es gibt hier kein ‚Äûzu viel‚Äú und kein ‚Äûfalsch‚Äú.";

    nextLabelEl.textContent = "Weiter zu den Emotionen";
    backBtn.disabled = true;
    backBtn.style.opacity = 0.4;

    hintEl.textContent = "Wenn du bereit bist, tippe auf ‚ÄûWeiter zu den Emotionen‚Äú.";
  }

  // Schritt 2: Emotion(en) w√§hlen
  function renderStep2() {
    titleEl.textContent = "Welche Emotionen sp√ºrst du gerade?";
    descEl.textContent =
      "Tippe auf die Kacheln, die zu deinem Inneren passen. Du kannst 1‚Äì3 Emotionen ausw√§hlen. Es muss nicht perfekt sein ‚Äì dein Gef√ºhl reicht.";
    nextLabelEl.textContent = "Weiter";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;

    EMOTIONS.forEach(emo => {
      const btn = document.createElement("button");
      const isSelected = state.selectedEmotionIds.includes(emo.id);
      btn.className = "tile " + emo.color + (isSelected ? " selected" : "");
      btn.innerHTML = `
        <span class="emoji">${emo.emoji}</span>
        <span class="label">${emo.label}</span>
      `;
      btn.addEventListener("click", () => toggleEmotion(emo.id));
      gridEl.appendChild(btn);
    });

    hintEl.textContent = "W√§hle 1‚Äì3 Emotionen. Dann unten auf ‚ÄûWeiter‚Äú.";
  }

  // Schritt 3: Hauptemotion / Vorschalttext
  function renderStep3() {
    const selected = state.selectedEmotionIds.map(getEmotionById).filter(Boolean);
    secondaryLabelEl.textContent = `${selected.length} Emotion(en) gew√§hlt`;
    nextLabelEl.textContent = "Weiter";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;

    if (selected.length === 1) {
      const emo = selected[0];
      state.mainEmotionId = emo.id;

      titleEl.textContent = "Du hast diese Emotion gew√§hlt:";
      descEl.textContent =
        `Du bist gerade ${emo.kurz}.\n\nWir bleiben jetzt bei genau dieser Emotion und schauen, woher sie kommt und was sie dir sagen will. Tippe auf ‚ÄûWeiter‚Äú, wenn du bereit bist.`;

      gridEl.innerHTML = "";
      hintEl.textContent = "Wenn du soweit bist, tippe unten auf ‚ÄûWeiter‚Äú.";

    } else {
      titleEl.textContent = "F√ºr welche Emotion entscheidest du dich jetzt?";
      descEl.textContent =
        "Du hast mehrere Emotionen gew√§hlt. Entscheide dich f√ºr die, die sich gerade am deutlichsten anf√ºhlt.";

      selected.forEach(emo => {
        const isActive = state.mainEmotionId === emo.id;
        const btn = document.createElement("button");
        btn.className = "tile " + emo.color + (isActive ? " selected" : "");
        btn.innerHTML = `
          <span class="emoji">${emo.emoji}</span>
          <span class="label">${emo.label}</span>
        `;
        btn.addEventListener("click", () => {
          state.mainEmotionId = emo.id;
          render();
        });
        gridEl.appendChild(btn);
      });

      hintEl.textContent = "Tippe die Emotion an, f√ºr die du dich entscheiden m√∂chtest.";
    }
  }

  // Schritt 4: Herkunft ‚Äì Kindheit / Vergangenheit / heute
  function renderStep4() {
    const emo = getEmotionById(state.mainEmotionId);
    titleEl.textContent = "Woher kennst du dieses Gef√ºhl?";
    descEl.textContent =
      (emo
        ? `Wenn du an ${emo.label} denkst: Woher kennst du dieses Gef√ºhl vor allem?`
        : "Woher kennst du dieses Gef√ºhl vor allem?");

    nextLabelEl.textContent = "Weiter";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;

    const options = [
      { id: "kindheit", label: "Aus meiner Kindheit", emoji: "üßí" },
      { id: "vergangenheit", label: "Aus fr√ºheren Erfahrungen / Beziehungen", emoji: "üìö" },
      { id: "heute", label: "Vor allem aus der aktuellen Situation", emoji: "üìÜ" },
      { id: "beides", label: "Es f√ºhlt sich an wie alte Wunde + heute", emoji: "ü©π" },
      { id: "unklar", label: "Ich kann es nicht einordnen", emoji: "üå´Ô∏è" }
    ];

    options.forEach(opt => {
      const btn = document.createElement("button");
      const selected = state.origin === opt.id;
      btn.className = "tile blue" + (selected ? " selected" : "");
      btn.innerHTML = `
        <span class="emoji">${opt.emoji}</span>
        <span class="label">${opt.label}</span>
      `;
      btn.addEventListener("click", () => {
        state.origin = opt.id;
        render();
      });
      gridEl.appendChild(btn);
    });

    hintEl.textContent = "Es reicht, wenn eine Antwort sich ‚Äûungef√§hr richtig‚Äú anf√ºhlt.";
  }

  // Schritt 5: H√§ufigkeit
  function renderStep5() {
    titleEl.textContent = "Hast du diese Emotion √∂fter?";
    descEl.textContent =
      "Schau ehrlich hin: Wie oft taucht dieses Gef√ºhl in deinem Leben auf?";

    nextLabelEl.textContent = "Weiter";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;

    const options = [
      { id: "sehr_oft", label: "Das begleitet mich schon lange und oft", emoji: "üîÑ" },
      { id: "manchmal", label: "Es kommt immer mal wieder", emoji: "üå¶Ô∏è" },
      { id: "selten", label: "Es ist eher selten, ich bin √ºberrascht", emoji: "‚ú®" },
      { id: "welle", label: "Es kommt in Wellen ‚Äì mal stark, mal weg", emoji: "üåä" }
    ];

    options.forEach(opt => {
      const btn = document.createElement("button");
      const selected = state.frequency === opt.id;
      btn.className = "tile rose" + (selected ? " selected" : "");
      btn.innerHTML = `
        <span class="emoji">${opt.emoji}</span>
        <span class="label">${opt.label}</span>
      `;
      btn.addEventListener("click", () => {
        state.frequency = opt.id;
        render();
      });
      gridEl.appendChild(btn);
    });

    hintEl.textContent = "Deine Ehrlichkeit hilft dir mehr als eine perfekte Antwort.";
  }

  // Schritt 6: Wie kommst du damit zurecht?
  function renderStep6() {
    titleEl.textContent = "Wie kommst du mit dieser Emotion zurecht?";
    descEl.textContent =
      "Was machst du normalerweise, wenn dieses Gef√ºhl da ist? Wie gehst du damit um?";

    nextLabelEl.textContent = "Zum Bibelvers";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;

    const options = [
      { id: "unterdruecken", label: "Ich schlucke es runter und funktioniere", emoji: "üé≠" },
      { id: "explodieren", label: "Ich halte es lange aus und explodiere irgendwann", emoji: "üí£" },
      { id: "flucht", label: "Ich lenke mich ab oder fliehe innerlich", emoji: "üèÉ" },
      { id: "teilen", label: "Ich kann vorsichtig mit jemandem dar√ºber reden", emoji: "ü§ù" },
      { id: "gebet", label: "Ich bringe es (manchmal) im Gebet zu Gott", emoji: "üôè" }
    ];

    options.forEach(opt => {
      const btn = document.createElement("button");
      const selected = state.coping === opt.id;
      btn.className = "tile green" + (selected ? " selected" : "");
      btn.innerHTML = `
        <span class="emoji">${opt.emoji}</span>
        <span class="label">${opt.label}</span>
      `;
      btn.addEventListener("click", () => {
        state.coping = opt.id;
        render();
      });
      gridEl.appendChild(btn);
    });

    hintEl.textContent = "Auch wenn dir deine Reaktion nicht gef√§llt: Du darfst sie hier ehrlich ansehen.";
  }

  // Schritt 7: Bibelvers & Erkl√§rung
  function renderStep7() {
    const emo = getEmotionById(state.mainEmotionId);
    titleEl.textContent = "Gottes Blick auf dein Gef√ºhl.";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;
    nextLabelEl.textContent = "Was m√∂chtest du jetzt tun?";

    let lines = [];
    if (emo) {
      lines.push(`Du bist gerade ${emo.kurz}.`);
    }
    if (state.origin) {
      const map = {
        kindheit: "Dieses Gef√ºhl kennst du schon seit deiner Kindheit.",
        vergangenheit: "Dieses Gef√ºhl kennst du aus fr√ºheren Erfahrungen oder Beziehungen.",
        heute: "Dieses Gef√ºhl ist stark mit deiner aktuellen Situation verkn√ºpft.",
        beides: "Es f√ºhlt sich an wie eine alte Wunde, die durch die aktuelle Situation angesto√üen wurde.",
        unklar: "Du kannst die Herkunft noch nicht genau einordnen ‚Äì und das ist okay."
      };
      lines.push(map[state.origin]);
    }
    if (state.frequency) {
      const map = {
        sehr_oft: "Es begleitet dich schon lange und ist fast ein alter Bekannter.",
        manchmal: "Es kommt immer mal wieder und meldet sich in bestimmten Phasen.",
        selten: "Es ist eher selten ‚Äì vielleicht genau deshalb so intensiv.",
        welle: "Es kommt in Wellen ‚Äì mal sehr stark, mal kaum sp√ºrbar."
      };
      lines.push(map[state.frequency]);
    }

    lines.push("\nGott sieht dieses Gef√ºhl klarer, als du es erkl√§ren kannst. Er verurteilt dich nicht daf√ºr ‚Äì er l√§dt dich ein, mit ihm hindurchzugehen.");

    descEl.textContent = lines.join("\n");

    if (emo) {
      verseBoxEl.style.display = "block";
      verseRefEl.textContent = emo.verseRef;
      verseTextEl.textContent = emo.verseText;
      verseExplEl.textContent = emo.expl;
    } else {
      verseBoxEl.style.display = "none";
    }

    gridEl.innerHTML = "";
    hintEl.textContent = "Lies langsam. Du musst nichts tun ‚Äì nur kurz hinh√∂ren.";
  }

  // Schritt 8: Was m√∂chtest du jetzt tun?
  function renderStep8() {
    titleEl.textContent = "Was m√∂chtest du jetzt ganz praktisch tun?";
    descEl.textContent =
      "Du musst dein Leben nicht heute komplett √§ndern. Es reicht ein kleiner, echter Schritt. Was w√ºrde dir jetzt guttun?";

    nextLabelEl.textContent = "Neu starten";
    backBtn.disabled = false;
    backBtn.style.opacity = 1;

    const options = [
      { id: "luft", label: "Kurz rausgehen und frische Luft holen", emoji: "üçÉ" },
      { id: "spaziergang", label: "Einen kleinen Spaziergang machen", emoji: "üö∂" },
      { id: "still", label: "Ein paar Minuten still vor Gott sitzen", emoji: "üïØÔ∏è" },
      { id: "schreiben", label: "Die Gedanken / Gef√ºhle kurz aufschreiben", emoji: "‚úçÔ∏è" },
      { id: "reden", label: "Mit einem vertrauten Menschen reden", emoji: "üëÇ" },
      { id: "nichts", label: "Gar nichts tun ‚Äì nur f√ºhlen und atmen", emoji: "üí§" }
    ];

    options.forEach(opt => {
      const btn = document.createElement("button");
      const selected = state.action === opt.id;
      btn.className = "tile orange" + (selected ? " selected" : "");
      btn.innerHTML = `
        <span class="emoji">${opt.emoji}</span>
        <span class="label">${opt.label}</span>
      `;
      btn.addEventListener("click", () => {
        state.action = opt.id;
        render();
      });
      gridEl.appendChild(btn);
    });

    let summary = [];
    const emo = getEmotionById(state.mainEmotionId);
    if (emo) summary.push(`Du bist gerade ${emo.kurz}.`);
    if (state.action) {
      const map = {
        luft: "Du m√∂chtest deinem K√∂rper etwas Gutes tun und frische Luft holen.",
        spazierung: "",
        spaziergang: "Du m√∂chtest in Bewegung kommen und drau√üen Luft holen.",
        still: "Du m√∂chtest bewusst mit Gott still werden.",
        schreiben: "Du m√∂chtest deine Gedanken ordnen und sie aufschreiben.",
        reden: "Du m√∂chtest nicht allein bleiben, sondern mit jemandem reden.",
        nichts: "Du m√∂chtest einfach nur f√ºhlen, ohne sofort etwas tun zu m√ºssen."
      };
      summary.push(map[state.action] || "");
    }
    summary.push("\nEgal, wie gro√ü oder klein dein Schritt ist: Gott geht ihn mit dir.");

    hintEl.textContent = summary.join(" ");
  }

  function toggleEmotion(id) {
    const idx = state.selectedEmotionIds.indexOf(id);
    if (idx !== -1) {
      state.selectedEmotionIds.splice(idx, 1);
    } else {
      if (state.selectedEmotionIds.length >= 3) {
        hintEl.textContent = "Maximal drei Emotionen gleichzeitig ‚Äì sonst wird es zu voll. üôÇ";
        return;
      }
      state.selectedEmotionIds.push(id);
    }
    render();
  }

  function handleNext() {
    if (state.step === 1) {
      state.step = 2;
      render();
    } else if (state.step === 2) {
      if (state.selectedEmotionIds.length === 0) {
        hintEl.textContent = "W√§hle mindestens eine Emotion aus, damit wir weitermachen k√∂nnen.";
        return;
      }
      state.step = 3;
      if (state.selectedEmotionIds.length === 1) {
        state.mainEmotionId = state.selectedEmotionIds[0];
      } else {
        state.mainEmotionId = null;
      }
      render();
    } else if (state.step === 3) {
      if (!state.mainEmotionId) {
        hintEl.textContent = "Bitte entscheide dich f√ºr eine Emotion.";
        return;
      }
      state.step = 4;
      render();
    } else if (state.step === 4) {
      if (!state.origin) {
        hintEl.textContent = "W√§hle eine Antwort, die ungef√§hr passt.";
        return;
      }
      state.step = 5;
      render();
    } else if (state.step === 5) {
      if (!state.frequency) {
        hintEl.textContent = "W√§hle, wie vertraut dir dieses Gef√ºhl ist.";
        return;
      }
      state.step = 6;
      render();
    } else if (state.step === 6) {
      if (!state.coping) {
        hintEl.textContent = "W√§hle, wie du normalerweise damit umgehst.";
        return;
      }
      state.step = 7;
      render();
    } else if (state.step === 7) {
      state.step = 8;
      render();
    } else if (state.step === 8) {
      // Neustart
      state.step = 1;
      state.selectedEmotionIds = [];
      state.mainEmotionId = null;
      state.origin = null;
      state.frequency = null;
      state.coping = null;
      state.action = null;
      render();
    }
  }

  function handleBack() {
    if (state.step === 1) return;
    state.step -= 1;
    if (state.step < 1) state.step = 1;
    render();
  }

  backBtn.addEventListener("click", handleBack);
  nextBtn.addEventListener("click", handleNext);

  // Start
  render();
</script>
</body>
</html>
