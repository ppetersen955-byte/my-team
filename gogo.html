<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>NEW YORK CITY QUEST</title>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />

  <style>
    :root {
      --bg: #020617;
      --bg2: #0b1120;
      --panel: #020617;
      --accent1: #22c55e;
      --accent2: #fb923c;
      --accent3: #38bdf8;
      --txt-main: #e5e7eb;
      --txt-muted: #9ca3af;
      --border: #111827;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
    }

    body {
      background:
        radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
      display: flex;
      justify-content: center;
      align-items: stretch;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      -webkit-text-size-adjust: 100%;
      color: var(--txt-main);
      overscroll-behavior: none;
    }

    .game {
      width: 100%;
      max-width: 560px;
      margin: 0 auto;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-height: 100vh;
    }

    .game-header {
      text-align: center;
      font-size: 11px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--txt-muted);
    }

    .scene-container {
      flex: 1;
      background: radial-gradient(circle at top, #020617 0, #000 100%);
      border-radius: 18px;
      border: 1px solid var(--border);
      box-shadow:
        0 18px 40px rgba(0,0,0,0.8),
        inset 0 0 0 1px rgba(148,163,184,0.12);
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .scene-bg {
      height: 38vh;
      min-height: 160px;
      border-radius: 12px;
      border: 1px solid #020617;
      box-shadow:
        inset 0 0 16px rgba(0,0,0,0.9),
        0 0 0 1px rgba(15,23,42,0.7);
      position: relative;
      overflow: hidden;
      image-rendering: pixelated;
    }

    .scene-bg::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image: linear-gradient(
        rgba(0,0,0,0.3) 1px,
        transparent 1px
      );
      background-size: 100% 3px;
      pointer-events: none;
      opacity: 0.45;
    }

    /* Start: New York Skyline */

    .bg-menu {
      background:
        radial-gradient(circle at top, #38bdf8 0, #0f172a 40%, #020617 100%);
    }
    .bg-menu .layer-1 {
      position: absolute;
      inset: auto 0 40px;
      height: 34px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 6px,
          #0b1120 6px,
          #0b1120 12px
        );
    }
    .bg-menu .layer-2 {
      position: absolute;
      inset: auto 0 18px;
      height: 58px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 10px,
          #111827 10px,
          #111827 20px
        );
      clip-path: polygon(
        0 50%, 6% 5%, 13% 50%, 24% 10%,
        35% 55%, 47% 8%, 55% 60%, 68% 15%,
        80% 52%, 90% 12%, 100% 50%, 100% 100%, 0 100%
      );
    }
    .bg-menu .layer-3 {
      position: absolute;
      inset: auto 0 0;
      height: 26px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 14px,
          #0f172a 14px,
          #0f172a 28px
        );
    }

    /* Park */

    .bg-park {
      background:
        linear-gradient(to top, #022c22 0, #064e3b 40%, #0f172a 75%, #020617 100%);
    }
    .bg-park .ground {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 50px;
      background:
        repeating-linear-gradient(
          to right,
          #022c22,
          #022c22 10px,
          #065f46 10px,
          #065f46 20px
        );
    }
    .bg-park .bench {
      position: absolute;
      bottom: 26px;
      left: 50%;
      width: 120px;
      height: 18px;
      transform: translateX(-50%);
      background:
        repeating-linear-gradient(
          to right,
          #111827,
          #111827 8px,
          #020617 8px,
          #020617 16px
        );
      box-shadow: 0 4px 0 #020617;
    }
    .bg-park .bench::after {
      content: "";
      position: absolute;
      inset: auto 20px -8px 20px;
      height: 8px;
      background: #020617;
      box-shadow: -50px 0 0 #020617, 50px 0 0 #020617;
    }
    .bg-park .tree {
      position: absolute;
      bottom: 35px;
      left: 20px;
      width: 26px;
      height: 40px;
      background: #14532d;
      border-radius: 50% 50% 10% 10%;
      box-shadow: 55px 4px 0 #166534, 200px 2px 0 #14532d;
    }

    /* Fast Food */

    .bg-fastfood {
      background:
        linear-gradient(to top, #7f1d1d 0, #b91c1c 40%, #0f172a 75%, #020617 100%);
    }
    .bg-fastfood .front {
      position: absolute;
      bottom: 0;
      left: 10%;
      right: 10%;
      height: 80px;
      background:
        repeating-linear-gradient(
          to right,
          #111827,
          #111827 12px,
          #020617 12px,
          #020617 24px
        );
    }
    .bg-fastfood .band {
      position: absolute;
      bottom: 56px;
      left: 14%;
      right: 14%;
      height: 10px;
      background:
        repeating-linear-gradient(
          to right,
          #fecaca,
          #fecaca 6px,
          #fee2e2 6px,
          #fee2e2 12px
        );
    }
    .bg-fastfood .sign {
      position: absolute;
      bottom: 76px;
      left: 50%;
      transform: translateX(-50%);
      width: 90px;
      height: 14px;
      background: #f97316;
      box-shadow: 0 0 10px rgba(248,113,113,0.85);
    }

    /* Library */

    .bg-library {
      background:
        linear-gradient(to top, #1f2937 0, #111827 50%, #020617 100%);
    }
    .bg-library .steps {
      position: absolute;
      bottom: 0;
      left: 8%;
      right: 8%;
      height: 40px;
      background:
        repeating-linear-gradient(
          to top,
          #020617,
          #020617 8px,
          #111827 8px,
          #111827 16px
        );
    }
    .bg-library .columns {
      position: absolute;
      bottom: 40px;
      left: 12%;
      right: 12%;
      height: 60px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 12px,
          #4b5563 12px,
          #4b5563 18px
        );
    }
    .bg-library .sign {
      position: absolute;
      bottom: 90px;
      left: 50%;
      transform: translateX(-50%);
      width: 110px;
      height: 12px;
      background: #9ca3af;
    }

    /* Street */

    .bg-street {
      background:
        linear-gradient(to top, #020617 0, #111827 45%, #0b1120 100%);
    }
    .bg-street .road {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 14px,
          #030712 14px,
          #030712 28px
        );
    }
    .bg-street .road::before {
      content: "";
      position: absolute;
      top: 16px;
      left: 0;
      right: 0;
      height: 4px;
      background:
        repeating-linear-gradient(
          to right,
          #facc15,
          #facc15 10px,
          transparent 10px,
          transparent 20px
        );
    }
    .bg-street .blocks {
      position: absolute;
      bottom: 40px;
      left: 8%;
      right: 8%;
      height: 70px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 12px,
          #111827 12px,
          #111827 24px
        );
    }

    /* Hotel */

    .bg-hotel {
      background:
        linear-gradient(to top, #020617 0, #0f172a 40%, #020617 100%);
    }
    .bg-hotel .facade {
      position: absolute;
      bottom: 0;
      left: 10%;
      right: 10%;
      height: 90px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 10px,
          #111827 10px,
          #111827 20px
        );
    }
    .bg-hotel .door {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 48px;
      height: 42px;
      background: #020617;
      border: 2px solid #374151;
    }
    .bg-hotel .logo {
      position: absolute;
      bottom: 82px;
      left: 50%;
      transform: translateX(-50%);
      width: 130px;
      height: 14px;
      background: #f97316;
      box-shadow: 0 0 12px rgba(248,113,113,0.9);
    }

    /* Boiler */

    .bg-boiler {
      background:
        radial-gradient(circle at top, #0f172a 0, #020617 60%, #000000 100%);
    }
    .bg-boiler .pipes {
      position: absolute;
      bottom: 60px;
      left: 0;
      right: 0;
      height: 30px;
      background:
        repeating-linear-gradient(
          to right,
          #111827,
          #111827 16px,
          #020617 16px,
          #020617 30px
        );
    }
    .bg-boiler .boiler {
      position: absolute;
      bottom: 26px;
      left: 20%;
      width: 90px;
      height: 60px;
      background: #020617;
      border: 2px solid #4b5563;
      box-shadow: 0 0 10px rgba(148,163,184,0.7);
    }
    .bg-boiler .mattress {
      position: absolute;
      bottom: 8px;
      right: 12%;
      width: 100px;
      height: 20px;
      background:
        repeating-linear-gradient(
          to right,
          #e5e7eb,
          #e5e7eb 10px,
          #cbd5f5 10px,
          #cbd5f5 20px
        );
      box-shadow: 0 3px 0 #020617;
    }

    /* Corridor */

    .bg-corridor {
      background:
        linear-gradient(to top, #111827 0, #020617 65%, #000 100%);
    }
    .bg-corridor .floor {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40px;
      background:
        repeating-linear-gradient(
          to right,
          #020617,
          #020617 14px,
          #030712 14px,
          #030712 28px
        );
    }
    .bg-corridor .door {
      position: absolute;
      bottom: 40px;
      width: 40px;
      height: 60px;
      background: #020617;
      border: 2px solid #374151;
      box-shadow: 0 0 6px rgba(148,163,184,0.4);
    }
    .bg-corridor .door.d1 { left: 15%; }
    .bg-corridor .door.d2 { left: 45%; }
    .bg-corridor .door.d3 { left: 75%; }

    .scene-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
    }

    .scene-header {
      text-align: center;
    }

    .scene-title {
      font-family: "Courier New", monospace;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      font-size: 14px;
    }

    .scene-location {
      font-size: 11px;
      color: var(--txt-muted);
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .scene-text {
      margin-top: 6px;
      font-family: "Courier New", monospace;
      font-size: 12px;
      line-height: 1.4;
      white-space: pre-wrap;
      max-height: 160px;
      overflow-y: auto;
      padding-right: 2px;
    }

    .choices {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .choice-btn {
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: rgba(15,23,42,0.95);
      padding: 7px 10px;
      font-size: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      color: var(--txt-main);
    }

    .choice-btn span.label {
      flex: 1;
      text-align: left;
      font-size: 12px;
    }

    .choice-btn span.icon {
      margin-left: 8px;
      font-size: 13px;
      opacity: 0.8;
    }

    .choice-btn:active {
      background: #111827;
      box-shadow: none;
    }

    .scene-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 10px;
      color: var(--txt-muted);
      margin-top: 6px;
    }

    .pill {
      border-radius: 999px;
      border: 1px solid #1f2937;
      padding: 3px 8px;
      font-family: "Courier New", monospace;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 9px;
      background: rgba(15,23,42,0.9);
    }

    .sound-indicator {
      display: inline-flex;
      gap: 4px;
      align-items: center;
      font-family: "Courier New", monospace;
      font-size: 10px;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #ef4444;
      box-shadow: 0 0 6px rgba(239,68,68,0.9);
    }

    .dot.on {
      background: #22c55e;
      box-shadow: 0 0 6px rgba(34,197,94,0.9);
    }

    .game-footer {
      text-align: center;
      font-size: 10px;
      color: var(--txt-muted);
      padding-bottom: 2px;
    }

    button {
      font-size: 16px; /* gegen iOS-Zoom beim Tippen */
    }
  </style>
</head>
<body>
<div class="game" id="root">
  <div class="game-header">NEW YORK CITY QUEST Â· HTML-ADVENTURE</div>

  <div class="scene-container">
    <div class="scene-bg bg-menu" id="scene-bg">
      <div class="layer-1"></div>
      <div class="layer-2"></div>
      <div class="layer-3"></div>
    </div>

    <div class="scene-panel">
      <div class="scene-header">
        <div class="scene-title" id="scene-title">NEW YORK CITY QUEST</div>
        <div class="scene-location" id="scene-location">HauptmenÃ¼</div>
      </div>

      <div class="scene-text" id="scene-text">
Willkommen bei NEW YORK CITY QUEST.

Ein 90er-Jahre-Pixel-Abenteuer in New York.

Du wachst im Central Park auf, dein Handy ist leer
und dein bester Freund steckt im Hotel Savoy fest.

â€¢ â€Spiel startenâ€œ beginnt die Geschichte.
â€¢ â€Musik an/ausâ€œ schaltet die 8-Bit-Musik.
      </div>

      <div class="choices" id="choices"></div>

      <div class="scene-footer">
        <div class="pill" id="chapter-pill">CHAPTER Â· MENU</div>
        <div class="sound-indicator">
          <div class="dot" id="sound-dot"></div>
          <span id="sound-label">Musik: AUS</span>
        </div>
      </div>
    </div>
  </div>

  <div class="game-footer">
    Tipp: Seite als App auf den Homescreen legen.
  </div>
</div>

<script>
  // -------- Musik (8-Bit) --------
  let audioCtx = null;
  let musicOn = false;
  let musicInterval = null;

  const soundDot = document.getElementById("sound-dot");
  const soundLabel = document.getElementById("sound-label");

  function initAudio() {
    if (audioCtx) return;
    const AC = window.AudioContext || window.webkitAudioContext;
    if (!AC) {
      soundLabel.textContent = "Musik: nicht unterstÃ¼tzt";
      return;
    }
    audioCtx = new AC();
  }

  function startMusic() {
    if (!audioCtx || musicOn) return;
    musicOn = true;
    soundDot.classList.add("on");
    soundLabel.textContent = "Musik: AN";

    const notes = [261.63, 329.63, 392.00, 523.25, 392.00, 329.63]; // kleines Motiv
    let step = 0;
    if (musicInterval) clearInterval(musicInterval);

    musicInterval = setInterval(() => {
      if (!musicOn || !audioCtx) return;
      const now = audioCtx.currentTime;

      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();

      osc.type = "square";
      osc.frequency.value = notes[step % notes.length];

      gain.gain.setValueAtTime(0.18, now);
      gain.gain.exponentialRampToValueAtTime(0.001, now + 0.23);

      osc.connect(gain);
      gain.connect(audioCtx.destination);

      osc.start(now);
      osc.stop(now + 0.24);

      step++;
    }, 260);
  }

  function stopMusic() {
    musicOn = false;
    soundDot.classList.remove("on");
    soundLabel.textContent = "Musik: AUS";
    if (musicInterval) clearInterval(musicInterval);
    musicInterval = null;
  }

  function toggleMusic() {
    if (!audioCtx) {
      initAudio();
      if (!audioCtx) return;
      audioCtx.resume && audioCtx.resume();
      startMusic();
      return;
    }
    if (musicOn) {
      stopMusic();
    } else {
      audioCtx.resume && audioCtx.resume();
      startMusic();
    }
  }

  // -------- Szenen --------
  const sceneBg = document.getElementById("scene-bg");
  const sceneTitleEl = document.getElementById("scene-title");
  const sceneLocationEl = document.getElementById("scene-location");
  const sceneTextEl = document.getElementById("scene-text");
  const choicesEl = document.getElementById("choices");
  const chapterPill = document.getElementById("chapter-pill");

  let currentSceneId = "menu";

  const scenes = {
    menu: {
      id: "menu",
      title: "NEW YORK CITY QUEST",
      location: "HauptmenÃ¼",
      chapter: "MENU",
      bg: "menu",
      text:
`Willkommen bei NEW YORK CITY QUEST.

Ein 90er-Jahre-Pixel-Abenteuer in New York.

Du wachst im Central Park auf, dein Handy ist leer
und dein bester Freund steckt im Hotel Savoy fest.

â€¢ â€Spiel startenâ€œ beginnt die Geschichte.
â€¢ â€Musik an/ausâ€œ schaltet die 8-Bit-Musik.`,
      choices: [
        { label: "ğŸ® Spiel starten", action: "startGame" },
        { label: "ğŸµ Musik an/aus", action: "toggleMusicOnly" }
      ]
    },

    // PARK
    park: {
      id: "park",
      title: "Aufwachen im Park",
      location: "Central Park",
      chapter: "CHAPTER 1",
      bg: "park",
      text:
`Du wachst auf einer Parkbank im Central Park auf.
Dein Kopf hÃ¤mmert, deine Erinnerung ist Nebel.

Du tastest deine Hosentasche â€“ dein Smartphone.
Aber: Akku 0%.

Du brauchst Strom.

Vor dir ein Wegweiser:
â€Staatsbibliothek â€“ 700 mâ€œ.

GegenÃ¼ber ein grell beleuchtetes Schnellrestaurant.`,
      choices: [
        { label: "ğŸ‘¥ Kurz einen Passanten fragen (Hinweis)", next: "park_hint" },
        { label: "ğŸ“š Zur Staatsbibliothek gehen", next: "library_fail" },
        { label: "ğŸ” Ins Schnellrestaurant gehen", next: "fastfood" }
      ]
    },

    park_hint: {
      id: "park_hint",
      title: "Warnung",
      location: "Central Park",
      chapter: "CHAPTER 1",
      bg: "park",
      text:
`Du sprichst einen alten Mann an, der Saxophon spielt.

Er schmunzelt:
â€Bibliothek? Pass auf dich auf.
Vor groÃŸen Treppen stehen oft Leute, die mehr wollen
als nur 'helfen'.â€œ

Er deutet mit dem Sax in Richtung Stadt:
â€Wenn dein Handy leer ist, such dir lieber einen Laden.â€œ`,
      choices: [
        { label: "ğŸ“š Trotzdem zur Staatsbibliothek", next: "library_fail" },
        { label: "ğŸ” Auf ihn hÃ¶ren und ins Schnellrestaurant", next: "fastfood" }
      ]
    },

    library_fail: {
      id: "library_fail",
      title: "Scam an der Bibliothek",
      location: "Staatsbibliothek",
      chapter: "GAME OVER",
      bg: "library",
      text:
`Du lÃ¤ufst die breite Treppe der Staatsbibliothek hinauf.

Vor dem Eingang stehen drei Leute mit Klemmbrettern.
â€Hey, wir haben hier eine Steckdose fÃ¼r dich,
kannst dein Handy kostenlos laden â€¦â€œ

Ehe du reagierst, hat einer dein Smartphone in der Hand.
â€Wir mÃ¼ssen nur kurz was einstellen â€¦â€œ

Zwei Minuten spÃ¤ter sind sie weg.
Kein Handy, kein Akku, kein Freund.

Dein New-York-Quest endet hier â€“
im Scam vor der Bibliothek.`,
      choices: [
        { label: "ğŸ”„ ZurÃ¼ck zur Parkbank â€“ neuer Versuch", next: "park" },
        { label: "ğŸ  ZurÃ¼ck ins HauptmenÃ¼", next: "menu" }
      ]
    },

    // FASTFOOD
    fastfood: {
      id: "fastfood",
      title: "Neon & Fritteusenduft",
      location: "Schnellrestaurant",
      chapter: "CHAPTER 2",
      bg: "fastfood",
      text:
`Du trittst ins Schnellrestaurant.
Neonlicht. Fettgeruch. Stimmen.

An der Wand findest du eine Steckdose.
Du steckst dein Handy ein â€“ der Akku fÃ¼llt sich langsam.

Auf dem Nachbartisch steht ein halb gegessener Burger,
Pommes, Cola.

Dein Magen knurrt laut.`,
      choices: [
        { label: "ğŸŸ Den Burger & die Pommes essen", next: "fastfood_eat" },
        { label: "ğŸ™…â€â™‚ï¸ Nur warten, nichts anfassen", next: "fastfood_wait" },
        { label: "ğŸ‘©â€ğŸ³ Kurz mit der Mitarbeiterin reden (Hinweis)", next: "fastfood_hint" }
      ]
    },

    fastfood_hint: {
      id: "fastfood_hint",
      title: "Taxi-Warnung",
      location: "Schnellrestaurant",
      chapter: "CHAPTER 2",
      bg: "fastfood",
      text:
`Die Mitarbeiterin wischt den Tresen.

â€Wenn du hier irgendwohin musstâ€œ, sagt sie,
â€nimm nachts lieber kein zufÃ¤lliges Taxi von der StraÃŸe.
Manche fahren mit dir im Kreis, bis dein Geld weg ist.â€œ

Sie schaut kurz auf dein Handy.
â€In dieser Stadt kostet alles â€“ auch Vertrauen.â€œ`,
      choices: [
        { label: "ğŸŸ ZurÃ¼ck und den Burger essen", next: "fastfood_eat" },
        { label: "ğŸª‘ ZurÃ¼ck und nur warten", next: "fastfood_wait" }
      ]
    },

    fastfood_eat: {
      id: "fastfood_eat",
      title: "Satt & Akku voll",
      location: "Schnellrestaurant",
      chapter: "CHAPTER 2",
      bg: "fastfood",
      text:
`Du ziehst das Tablett zu dir.
Der Burger ist lauwarm, die Pommes weich,
aber dein Bauch feiert.

WÃ¤hrend du isst, klettert der Akku auf 100%.

Zeit, zu checken, was passiert ist.`,
      choices: [
        { label: "ğŸ“± Handy checken â€“ letzte Nachrichten", next: "messages" }
      ]
    },

    fastfood_wait: {
      id: "fastfood_wait",
      title: "Nur Akku",
      location: "Schnellrestaurant",
      chapter: "CHAPTER 2",
      bg: "fastfood",
      text:
`Du rÃ¼hrst das Essen nicht an.
Du starrst auf die Akku-Anzeige:

38% â€¦ 61% â€¦ 100%.

Du bist hungrig, aber dein Handy ist bereit.

Zeit, die Nachrichten zu checken.`,
      choices: [
        { label: "ğŸ“± Handy checken â€“ letzte Nachrichten", next: "messages" }
      ]
    },

    // HANDY & FREUND
    messages: {
      id: "messages",
      title: "Letzte Nachrichten",
      location: "Schnellrestaurant",
      chapter: "CHAPTER 3",
      bg: "fastfood",
      text:
`Du entsperrst dein Handy.
Ganz oben: der Chat mit deinem besten Freund.

â€Bro, ich bin im Hotel Savoy in New York.â€œ
â€Zimmer â€¦â€œ

Die Nachricht bricht mitten im Satz ab.

Kein â€Alles gutâ€œ, kein Emoji.
Nur dieses halbe â€Zimmer â€¦â€œ.

Du musst ihn finden.`,
      choices: [
        { label: "ğŸš• Taxi zum Hotel Savoy nehmen", next: "taxi_fail" },
        { label: "ğŸš¶â€â™‚ï¸ Zu FuÃŸ loslaufen â€“ Schilder suchen", next: "street" }
      ]
    },

    taxi_fail: {
      id: "taxi_fail",
      title: "Falsches Taxi",
      location: "Irgendwo in New York",
      chapter: "GAME OVER",
      bg: "street",
      text:
`Du steigst in ein Taxi.
â€Hotel Savoyâ€œ, sagst du.

Der Fahrer nickt, fÃ¤hrt los.
StraÃŸen, Lichter, Kreuzungen.

Nach einer Weile merkst du:
Ihr seid schon zweimal an derselben Ecke vorbei.

Als du fast kein Geld mehr hast,
setzt er dich irgendwo ab.

Kein Hotel. Kein Freund. Kein Plan.

New York frisst dich, wenn du dem Falschen vertraust.`,
      choices: [
        { label: "ğŸ”„ Nochmal â€“ diesmal zu FuÃŸ gehen", next: "street" },
        { label: "ğŸ  ZurÃ¼ck ins HauptmenÃ¼", next: "menu" }
      ]
    },

    // ZU FUSS
    street: {
      id: "street",
      title: "Zu FuÃŸ durch die Stadt",
      location: "StraÃŸen von New York",
      chapter: "CHAPTER 3",
      bg: "street",
      text:
`Du gehst zu FuÃŸ.
Die Luft ist kÃ¼hl, Abgase, Pizza-Geruch,
Musik aus offenen Fenstern.

Nach ein paar Blocks siehst du:
â€¢ Ein Schild: â€HOTEL SAVOY â†’â€œ
â€¢ Eine kleine SeitenstraÃŸe mit Musik`,
      choices: [
        { label: "ğŸ· In die SeitenstraÃŸe (StraÃŸenmusik)", next: "street_music" },
        { label: "ğŸ¨ Dem Schild zum Hotel Savoy folgen", next: "hotel_lobby" }
      ]
    },

    street_music: {
      id: "street_music",
      title: "StraÃŸenmusik",
      location: "SeitenstraÃŸe",
      chapter: "CHAPTER 3",
      bg: "street",
      text:
`In der SeitenstraÃŸe steht ein Typ mit Saxophon.
Ein Pappbecher mit MÃ¼nzen steht vor ihm.

â€Stressiger Tag?â€œ, fragt er zwischen zwei TÃ¶nen.

Du nickst.
â€Dann mach wenigstens eine gute Geschichte drausâ€œ,
sagt er und spielt weiter.

Du atmest einmal tief durch
und gehst zurÃ¼ck auf die HauptstraÃŸe.`,
      choices: [
        { label: "ğŸ¨ Zum Hotel Savoy weitergehen", next: "hotel_lobby" }
      ]
    },

    // HOTEL
    hotel_lobby: {
      id: "hotel_lobby",
      title: "Die Lobby",
      location: "Hotel Savoy",
      chapter: "CHAPTER 4",
      bg: "hotel",
      text:
`Das Hotel Savoy glÃ¤nzt.
Marmor, Gold, zu viel ParfÃ¼m in der Luft.

Du gehst zur Rezeption.
â€Ich suche meinen Freundâ€œ, sagst du
und nennst seinen Namen.

Die Rezeptionistin tippt.
â€Unter diesem Namen ist hier niemand eingechecktâ€œ, sagt sie.

Die Luft wird schwer.`,
      choices: [
        { label: "ğŸ“ Deinen Freund anrufen", next: "call_fail" },
        { label: "ğŸ‘¥ GÃ¤ste in der Lobby ansprechen", next: "guests" }
      ]
    },

    call_fail: {
      id: "call_fail",
      title: "Mailbox",
      location: "Lobby",
      chapter: "CHAPTER 4",
      bg: "hotel",
      text:
`Du wÃ¤hlst seine Nummer.
Es klingelt â€¦ und klingelt â€¦

Mailbox.
Du legst auf.

Die Lobby fÃ¼hlt sich grÃ¶ÃŸer an
als vor wenigen Minuten.`,
      choices: [
        { label: "ğŸ‘¥ GÃ¤ste in der Lobby ansprechen", next: "guests" }
      ]
    },

    guests: {
      id: "guests",
      title: "Menschen im Hotel",
      location: "Lobby",
      chapter: "CHAPTER 4",
      bg: "hotel",
      text:
`Du schaust dich um.

â€¢ Ein gestresster GeschÃ¤ftsmann mit Aktenkoffer.
â€¢ Ein Hausmeister mit Werkzeugtasche.`,
      choices: [
        { label: "ğŸ’¼ GeschÃ¤ftsmann ansprechen", next: "guest_business" },
        { label: "ğŸ”§ Hausmeister ansprechen", next: "janitor_offer" }
      ]
    },

    guest_business: {
      id: "guest_business",
      title: "Smalltalk",
      location: "Lobby",
      chapter: "CHAPTER 4",
      bg: "hotel",
      text:
`â€Entschuldigungâ€œ, sagst du zum GeschÃ¤ftsmann,
â€haben Sie zufÃ¤llig einen Typ gesehen â€¦â€œ â€“ du beschreibst deinen Freund.

Er schÃ¼ttelt den Kopf.
â€Ich sehe hier nur meine Termineâ€œ, sagt er.
â€Wenn du was Ã¼ber das Haus wissen willst:
Frag den Hausmeister. Der kennt die Geschichten.â€œ`,
      choices: [
        { label: "ğŸ”§ Hausmeister ansprechen", next: "janitor_offer" }
      ]
    },

    janitor_offer: {
      id: "janitor_offer",
      title: "Der Deal",
      location: "Lobby",
      chapter: "CHAPTER 5",
      bg: "hotel",
      text:
`Der Hausmeister mustert dich.
â€Du siehst mÃ¼de ausâ€œ, sagt er,
â€aber nicht so, als hÃ¤ttest du hier ein Zimmer.â€œ

Du erklÃ¤rst die Situation.
Freund, Hotel, keine Buchung.

Er kratzt sich am Bart.
â€Ein offizielles Zimmer kann ich dir nicht geben.
Aber wenn du mir heute Nacht hilfst,
kann ich dir wenigstens einen Platz zum Schlafen anbieten.â€œ`,
      choices: [
        { label: "ğŸ§° Deal annehmen und helfen", next: "janitor_work" },
        { label: "ğŸšª Ablehnen und das Hotel verlassen (Game Over)", next: "hotel_leave_fail" }
      ]
    },

    hotel_leave_fail: {
      id: "hotel_leave_fail",
      title: "Aus der TÃ¼r",
      location: "StraÃŸe vor dem Hotel",
      chapter: "GAME OVER",
      bg: "street",
      text:
`Du schÃ¼ttelst den Kopf.
â€Ich kann nicht mehrâ€œ, murmelst du
und gehst nach drauÃŸen.

Die Stadt rauscht.
Lichter, Sirenen, Menschen â€“ aber keiner ist dein Freund.

Manche Geschichten enden nicht,
weil es keinen Weg gibt,
sondern weil einer stehen bleibt.`,
      choices: [
        { label: "ğŸ”„ Noch einmal in die Lobby gehen", next: "hotel_lobby" },
        { label: "ğŸ  ZurÃ¼ck ins HauptmenÃ¼", next: "menu" }
      ]
    },

    janitor_work: {
      id: "janitor_work",
      title: "Hausmeister-Nacht",
      location: "Flure & Zimmer",
      chapter: "CHAPTER 5",
      bg: "corridor",
      text:
`Du folgst dem Hausmeister.

Stundenlang:
GlÃ¼hbirnen wechseln,
quietschende TÃ¼ren Ã¶len,
kleine Reparaturen.

Zwischendurch sagt er:
â€FÃ¼r einen Freund arbeitest du verdammt viel.â€œ

Gegen 1 Uhr:
â€Okayâ€œ, sagt er, â€ich hab was im Heizungskeller.â€œ`,
      choices: [
        { label: "â¬‡ï¸ Mit in den Heizungskeller gehen", next: "boiler_room" }
      ]
    },

    boiler_room: {
      id: "boiler_room",
      title: "Heizungskeller",
      location: "Boilerraum",
      chapter: "CHAPTER 6",
      bg: "boiler",
      text:
`Der Heizungskeller ist warm.
Rohre, ein alter Boiler, leises Pfeifen.

In der Ecke:
eine Matratze auf Paletten.

â€Ist nicht schÃ¶nâ€œ, sagt der Hausmeister,
â€aber besser als nichts.
Schlaf ein bisschen. Morgen sehen wir weiter.â€œ`,
      choices: [
        { label: "ğŸ˜´ Hinlegen und schlafen", next: "night_wakeup" }
      ]
    },

    night_wakeup: {
      id: "night_wakeup",
      title: "Schreie in der Nacht",
      location: "Boilerraum",
      chapter: "CHAPTER 6",
      bg: "boiler",
      text:
`Du schlÃ¤fst ein.
Der Boiler brummt wie ein tiefer Bass.

Eine Stunde spÃ¤ter reiÃŸt dich Geschrei aus dem Schlaf.
Stimmen oben im Haus, wÃ¼tend, laut.

â€Sie haben kein Zimmer gebucht!â€œ
â€Sie kÃ¶nnen hier nicht einfach â€¦!â€œ

Dein Herz schlÃ¤gt schneller.`,
      choices: [
        { label: "ğŸ™ˆ Ignorieren und weiter schlafen (Game Over)", next: "sleep_fail" },
        { label: "ğŸš¶â€â™‚ï¸ Aufstehen und nachsehen", next: "corridor_investigate" }
      ]
    },

    sleep_fail: {
      id: "sleep_fail",
      title: "WeghÃ¶ren",
      location: "Boilerraum",
      chapter: "GAME OVER",
      bg: "boiler",
      text:
`Du ziehst dir die Decke Ã¼ber den Kopf.
â€Nicht mein Problemâ€œ, flÃ¼sterst du.

Die Stimmen werden leiser.
Irgendwann ist es still.

Am Morgen:
Der Hausmeister ist weg.
Die Rezeption kennt dich nicht.
Dein Freund ist verschwunden.

Manchmal ist Wegschauen die brutalste Entscheidung.`,
      choices: [
        { label: "ğŸ”„ Noch einmal â€“ diesmal nachsehen", next: "corridor_investigate" },
        { label: "ğŸ  ZurÃ¼ck ins HauptmenÃ¼", next: "menu" }
      ]
    },

    corridor_investigate: {
      id: "corridor_investigate",
      title: "Am Flur",
      location: "Hotelflur",
      chapter: "CHAPTER 7",
      bg: "corridor",
      text:
`Du schleichst den Flur entlang.
GedÃ¤mpftes Licht, schwerer Teppich.

Am Ende: eine geÃ¶ffnete TÃ¼r.
Innen siehst du:

â€¢ Deinen Kumpel
â€¢ Den Hoteldirektor
â€¢ Vier Security-Leute

â€Ihre Buchung existiert nichtâ€œ, zischt der Direktor.
â€Wer sind Sie wirklich?â€œ`,
      choices: [
        { label: "ğŸ˜¨ Dich verstecken und abwarten (Game Over)", next: "panic_fail" },
        { label: "ğŸ•¶ï¸ Mut fassen und reingehen", next: "police_bluff" }
      ]
    },

    panic_fail: {
      id: "panic_fail",
      title: "LÃ¤hmende Angst",
      location: "Hotelflur",
      chapter: "GAME OVER",
      bg: "corridor",
      text:
`Du drÃ¼ckst dich in eine Nische.
Dein Herz hÃ¤mmert.

Stimmen, Schritte, TÃ¼ren.
Dann Stille.

Als du dich bewegst, ist der Raum leer.
Dein Freund ist weg.

Angst ist normal.
Aber sie nimmt dir manchmal die eine Chance,
die du gebraucht hÃ¤ttest.`,
      choices: [
        { label: "ğŸ”„ Noch einmal â€“ diesmal mutig sein", next: "police_bluff" },
        { label: "ğŸ  ZurÃ¼ck ins HauptmenÃ¼", next: "menu" }
      ]
    },

    police_bluff: {
      id: "police_bluff",
      title: "Der Bluff",
      location: "Konferenzraum",
      chapter: "CHAPTER 7",
      bg: "corridor",
      text:
`Du atmest tief durch,
setz dir deinen In-Ear-KopfhÃ¶rer ins Ohr
und gehst einfach in den Raum.

Im Gehen tippst du den KopfhÃ¶rer an:
â€Yes, I have him. Copy. Iâ€™ll bring him up.â€œ

Der Direktor starrt dich an.
â€Wer sind Sie?â€œ`,
      choices: [
        { label: "ğŸ—£ï¸ â€NYPD. Ich Ã¼bernehme ihn.â€œ", next: "police_bluff_2" }
      ]
    },

    police_bluff_2: {
      id: "police_bluff_2",
      title: "Ãœbernahme",
      location: "Konferenzraum",
      chapter: "CHAPTER 7",
      bg: "corridor",
      text:
`Du stellst dich neben deinen Freund.
â€Ich nehme ihn mit.
Die Einheit wartet oben. Wir klÃ¤ren den Rest,
ohne dass Ihr Hotel morgen in den News ist.â€œ

Du tippst noch einmal an den In-Ear:
â€Ja, ich hab ihn. Ich bring ihn euch.â€œ

Dein Freund checkt es sofort und spielt mit,
als wÃ¤rst du wirklich von der Polizei.`,
      choices: [
        { label: "ğŸš¶â€â™‚ï¸ Freund im â€šPolizeigriffâ€˜ rausfÃ¼hren", next: "escape" }
      ]
    },

    escape: {
      id: "escape",
      title: "Raus aus dem Savoy",
      location: "StraÃŸe vor dem Hotel",
      chapter: "CHAPTER 8",
      bg: "street",
      text:
`Ihr tretet auf die StraÃŸe.
Die HoteltÃ¼r fÃ¤llt hinter euch zu.

Ihr lÃ¶st gleichzeitig den Griff
und fangt an zu lachen.

â€Alterâ€œ, sagt dein Freund,
â€das war das DÃ¼mmste und Mutigste,
was ich seit langem gesehen habe.â€œ`,
      choices: [
        { label: "ğŸ¨ Mit ihm in ein anderes Hotel gehen", next: "good_end" }
      ]
    },

    good_end: {
      id: "good_end",
      title: "Der Abend danach",
      location: "Anderes Hotel â€“ Dachterrasse",
      chapter: "GOOD END",
      bg: "hotel",
      text:
`SpÃ¤ter sitzt ihr auf der Dachterrasse
eines anderen Hotels.

Unter euch New York.
Ãœber euch der Himmel.

â€WeiÃŸt du nochâ€œ, sagt dein Freund,
â€wie du im Park aufgewacht bist,
ohne Plan und ohne Akku?â€œ

Du nickst.
â€Und jetzt sitzen wir hier
mit einer Geschichte, die uns keiner glaubt,
aber wir wissen, dass sie stimmt.â€œ

NEW YORK CITY QUEST
Â· GOOD END Â·`,
      choices: [
        { label: "ğŸ”„ Noch mal spielen â€“ andere Wege testen", next: "menu" }
      ]
    }
  };

  function renderScene(id) {
    const scene = scenes[id];
    if (!scene) return;
    currentSceneId = id;

    // Hintergrund
    sceneBg.className = "scene-bg bg-" + (scene.bg || "menu");
    sceneBg.innerHTML = "";
    if (scene.bg === "menu") {
      sceneBg.innerHTML = '<div class="layer-1"></div><div class="layer-2"></div><div class="layer-3"></div>';
    } else if (scene.bg === "park") {
      sceneBg.innerHTML = '<div class="ground"></div><div class="bench"></div><div class="tree"></div>';
    } else if (scene.bg === "fastfood") {
      sceneBg.innerHTML = '<div class="front"></div><div class="band"></div><div class="sign"></div>';
    } else if (scene.bg === "library") {
      sceneBg.innerHTML = '<div class="steps"></div><div class="columns"></div><div class="sign"></div>';
    } else if (scene.bg === "street") {
      sceneBg.innerHTML = '<div class="road"></div><div class="blocks"></div>';
    } else if (scene.bg === "hotel") {
      sceneBg.innerHTML = '<div class="facade"></div><div class="door"></div><div class="logo"></div>';
    } else if (scene.bg === "boiler") {
      sceneBg.innerHTML = '<div class="pipes"></div><div class="boiler"></div><div class="mattress"></div>';
    } else if (scene.bg === "corridor") {
      sceneBg.innerHTML = '<div class="floor"></div><div class="door d1"></div><div class="door d2"></div><div class="door d3"></div>';
    }

    // Text & Metadaten
    sceneTitleEl.textContent = scene.title;
    sceneLocationEl.textContent = scene.location;
    sceneTextEl.textContent = scene.text;
    chapterPill.textContent = scene.chapter;

    // Buttons
    choicesEl.innerHTML = "";
    (scene.choices || []).forEach(choice => {
      const btn = document.createElement("button");
      btn.className = "choice-btn";
      btn.innerHTML = `<span class="label">${choice.label}</span><span class="icon">â–¶</span>`;
      btn.addEventListener("click", () => handleChoice(choice));
      choicesEl.appendChild(btn);
    });
  }

  function handleChoice(choice) {
    if (choice.action === "startGame") {
      // Beim Start direkt Musik anschmeiÃŸen
      if (!audioCtx) {
        initAudio();
      }
      if (audioCtx) {
        audioCtx.resume && audioCtx.resume();
        startMusic();
      }
      renderScene("park");
      return;
    }

    if (choice.action === "toggleMusicOnly") {
      toggleMusic();
      return;
    }

    if (choice.next) {
      renderScene(choice.next);
    }
  }

  // Start im MenÃ¼
  renderScene("menu");
</script>
</body>
</html>
